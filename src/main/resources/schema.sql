-- Tabela Agencia
CREATE TABLE SPF_AGENCIA (
    CNPJ VARCHAR2(14),
    NOME VARCHAR2(255) NOT NULL,
    CONSTRAINT PK_SPF_AGENCIA PRIMARY KEY (CNPJ)
);

-- Tabela Equipe
CREATE TABLE SPF_EQUIPE (
    CNPJ VARCHAR2(14),
    NOME VARCHAR2(255) NOT NULL,
    NUMERO_INTEGRANTES NUMBER CHECK (NUMERO_INTEGRANTES > 0),
    CONSTRAINT PK_SPF_EQUIPE PRIMARY KEY (CNPJ)
);

-- Tabela Atleta
CREATE TABLE SPF_ATLETA (
    NOME_USUARIO VARCHAR2(255),
    SENHA VARCHAR2(20),
    NOME VARCHAR2(255) NOT NULL,
    DATA_NASCIMENTO DATE,
    ESPORTE VARCHAR2(255) NOT NULL,
    GENERO CHAR(1),
    AGENCIA_CNPJ VARCHAR2(14),
    EQUIPE_CNPJ VARCHAR2(14),
    CONSTRAINT PK_SPF_ATLETA PRIMARY KEY (NOME_USUARIO),
    CONSTRAINT FK_SPF_AGENCIA_SPF_ATLETA FOREIGN KEY (AGENCIA_CNPJ) REFERENCES SPF_AGENCIA(CNPJ),
    CONSTRAINT FK_SPF_EQUIPE_SPF_ATLETA FOREIGN KEY (EQUIPE_CNPJ) REFERENCES SPF_EQUIPE(CNPJ),
    CONSTRAINT SK_SPF_EQUIPE UNIQUE (AGENCIA_CNPJ)
);

-- Tabela Postagem
CREATE TABLE SPF_POSTAGEM (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    NOME_USUARIO VARCHAR2(255) NOT NULL,
    DATA_HORA TIMESTAMP NOT NULL,
    CURTIDAS NUMBER DEFAULT 0,
    COMENTARIOS NUMBER DEFAULT 0, -- VER COM O AFONSO
    CONSTRAINT PK_SPF_POSTAGEM PRIMARY KEY (ID),
    CONSTRAINT FK_SPF_ATLETA_SPF_POSTAGEM FOREIGN KEY (NOME_USUARIO) REFERENCES SPF_ATLETA(NOME_USUARIO),
    CONSTRAINT SK_SPF_POSTAGEM UNIQUE (NOME_USUARIO, DATA_HORA)
);

-- Tabela Midia (atributo multivalorado da tabela Postagem)
CREATE TABLE SPF_MIDIA (
    POSTAGEM_ID NUMBER,
    CONTEUDO VARCHAR2(255),
    CONSTRAINT PK_SPF_MIDIA PRIMARY KEY (POSTAGEM_ID, CONTEUDO),
    CONSTRAINT FK_SPF_POSTAGEM_SPF_MIDIA FOREIGN KEY (POSTAGEM_ID) REFERENCES SPF_POSTAGEM(ID)
);

-- Tabela Seguidor
CREATE TABLE SPF_SEGUIDOR (
    NOME_USUARIO_SEGUIDOR VARCHAR2(255),
    NOME_USUARIO_SEGUIDO VARCHAR2(255),
    CONSTRAINT PK_SPF_SEGUIDOR PRIMARY KEY (NOME_USUARIO_SEGUIDOR, NOME_USUARIO_SEGUIDO),
    CONSTRAINT FK_SPF_SEGUIDOR FOREIGN KEY (NOME_USUARIO_SEGUIDOR) REFERENCES SPF_ATLETA(NOME_USUARIO),
    CONSTRAINT FK_SPF_SEGUIDO FOREIGN KEY (NOME_USUARIO_SEGUIDO) REFERENCES SPF_ATLETA(NOME_USUARIO)
);

-- Tabela Patrocinador
CREATE TABLE SPF_PATROCINADOR (
    CNPJ VARCHAR2(14),
    ESFERA_DE_PODER VARCHAR2(255) NOT NULL,
    CONSTRAINT PK_SPF_PATROCINADOR PRIMARY KEY (CNPJ)
);

-- Tabela Governo
CREATE TABLE SPF_GOVERNO (
	CNPJ VARCHAR2(14),
    AREA_DE_ATUACAO VARCHAR2(255) NOT NULL,
    CONSTRAINT PK_SPF_GOVERNO PRIMARY KEY (CNPJ),
    CONSTRAINT FK_SPF_GOVERNO_SPF_PATROCINADOR FOREIGN KEY (CNPJ) REFERENCES SPF_PATROCINADOR(CNPJ)
);

-- Tabela Empresa
CREATE TABLE SPF_EMPRESA (
    CNPJ VARCHAR2(14),
    NOME VARCHAR2(255) NOT NULL,
    CONSTRAINT PK_SPF_EMPRESA PRIMARY KEY (CNPJ)
);

-- Tabela ProgramaIncentivo
CREATE TABLE SPF_PROGRAMA_INCENTIVO (
    GOVERNO_CNPJ VARCHAR2(14),
    NOME VARCHAR2(255),
    CONSTRAINT PK_SPF_PROGRAMA_INCENTIVO PRIMARY KEY (GOVERNO_CNPJ, NOME),
    CONSTRAINT FK_SPF_PROGRAMA_INCENTIVO_SPF_GOVERNO FOREIGN KEY (Governo_CNPJ) REFERENCES SPF_GOVERNO(CNPJ)
);

-- Tabela PatrocinioOferecido
CREATE TABLE SPF_PATROCINIO_OFERECIDO (
    EMPRESA_CNPJ VARCHAR2(14),
    NOME VARCHAR2(255),
    CONSTRAINT PK_SPF_PATROCINIO_OFERECIDO PRIMARY KEY (EMPRESA_CNPJ, NOME),
    CONSTRAINT FK_SPF_EMPRESA_SPF_PATROCINIO_OFERECIDO FOREIGN KEY (EMPRESA_CNPJ) REFERENCES SPF_EMPRESA(CNPJ)
);

-- Tabela Local
CREATE TABLE SPF_LOCAL (
    NOME VARCHAR2(255) NOT NULL,
    CEP VARCHAR2(9),
    NUMERO NUMBER CHECK (NUMERO > 0),
    CONSTRAINT PK_SPF_LOCAL PRIMARY KEY (CEP, NUMERO)
);

-- Tabela Patrocinio
CREATE TABLE SPF_PATROCINIO (
    NUM_CONTRATO VARCHAR2(20),
    VALORES NUMBER CHECK (VALORES > 0),
    INICIO DATE NOT NULL,
    FIM DATE,
    CONSTRAINT PK_SPF_PATROCINIO PRIMARY KEY (NUM_CONTRATO)
);

-- Tabela ServicosOferecidos
CREATE TABLE SPF_SERVICO_OFERECIDO (
    PATROCINIO_NUM_CONTRATO VARCHAR2(20),
    SERVICO VARCHAR2(255),
    CONSTRAINT PK_SPF_SERVICOS_OFERECIDOSs PRIMARY KEY (PATROCINIO_NUM_CONTRATO, SERVICO),
    CONSTRAINT FK_SPF_PATROCINIO_SPF_SERVICOS_OFERECIDOS FOREIGN KEY (PATROCINIO_NUM_CONTRATO) REFERENCES SPF_PATROCINIO(NUM_CONTRATO)
);

-- Tabela Fiscaliza
CREATE TABLE SPF_FISCALIZA (
    EMPRESA_CNPJ VARCHAR2(14),
    GOVERNO_CNPJ VARCHAR2(14),
    CONSTRAINT PK_SPF_FISCALIZA PRIMARY KEY (EMPRESA_CNPJ, GOVERNO_CNPJ),
    CONSTRAINT FK_SPF_EMPRESA_SPF_FISCALIZA FOREIGN KEY (EMPRESA_CNPJ) REFERENCES SPF_EMPRESA(CNPJ),
    CONSTRAINT FK_SPF_GOVERNO_SPF_FISCALIZA FOREIGN KEY (GOVERNO_CNPJ) REFERENCES SPF_GOVERNO(CNPJ)
);

-- Tabela Evento
CREATE TABLE SPF_EVENTO (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    DATA_HORA TIMESTAMP NOT NULL,
    NOME VARCHAR2(255) NOT NULL,
    PATROCINADOR_CNPJ VARCHAR2(14) NOT NULL,
    CEP VARCHAR2(9) NOT NULL,
    NUMERO_LOCAL NUMBER CHECK (NUMERO_LOCAL > 0) NOT NULL,
    CAPACIDADE NUMBER CHECK (CAPACIDADE > 0),
    CONSTRAINT PK_SPF_Evento PRIMARY KEY (ID),
    CONSTRAINT FK_SPF_PATROCINADOR_SPF_EVENTO FOREIGN KEY (PATROCINADOR_CNPJ) REFERENCES SPF_PATROCINADOR(CNPJ),
    CONSTRAINT FK_SPF_LOCAL_SPF_EVENTO FOREIGN KEY (CEP, NUMERO_LOCAL) REFERENCES SPF_LOCAL(CEP, NUMERO),
    CONSTRAINT SK_SPF_EVENTO UNIQUE (DATA_HORA, NOME, PATROCINADOR_CNPJ, CEP, NUMERO_LOCAL)
);

-- Tabela TipoEvento
CREATE TABLE SPF_TIPO_EVENTO (
    EVENTO_ID NUMBER,
    TIPO VARCHAR2(255),
    CONSTRAINT PK_SPF_TIPO_EVENTO PRIMARY KEY (EVENTO_ID, TIPO),
    CONSTRAINT FK_SPF_EVENTO_SPF_TIPO_EVENTO FOREIGN KEY (EVENTO_ID) REFERENCES SPF_EVENTO(ID)
);

-- Tabela EventoIndividual
CREATE TABLE SPF_EVENTO_INDIVIDUAL (
    EVENTO_ID NUMBER,
    CONSTRAINT PK_SPF_EVENTO_INDIVIDUAL PRIMARY KEY (EVENTO_ID),
    CONSTRAINT FK_SPF_EVENTO_SPF_EVENTO_INDIVIDUAL FOREIGN KEY (EVENTO_ID) REFERENCES SPF_EVENTO(ID)
);

-- Tabela EventoEquipe
CREATE TABLE SPF_EVENTO_EQUIPE (
    EVENTO_ID NUMBER,
    CONSTRAINT PK_SPF_EVENTO_EQUIPE PRIMARY KEY (EVENTO_ID),
    CONSTRAINT FK_SPF_EVENTO_SPF_EVENTO_EQUIPE FOREIGN KEY (EVENTO_ID) REFERENCES SPF_EVENTO(ID)
);

-- Tabela ParticipacaoIndividual
CREATE TABLE SPF_PARTICIPACAO_INDIVIDUAL (
	ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    NOME_USUARIO VARCHAR2(255) NOT NULL,
    EVENTO_ID NUMBER NOT NULL,
    MODALIDADE VARCHAR2(255) NOT NULL,
    CONSTRAINT PK_SPF_PARTICIPACAO_INDIVIDUAL PRIMARY KEY (ID),
    CONSTRAINT FK_SPF_ATLETA_SPF_PARTICIPACAO_INDIVIDUAL FOREIGN KEY (NOME_USUARIO) REFERENCES SPF_ATLETA(NOME_USUARIO),
    CONSTRAINT FK_SPF_EVENTO_SPF_PARTICIPACAO_INDIVIDUAL FOREIGN KEY (EVENTO_ID) REFERENCES SPF_EVENTO(ID),
    CONSTRAINT SK_SPF_PARTICIPACAO_INDIVIDUAL UNIQUE (NOME_USUARIO, EVENTO_ID, MODALIDADE)
);

-- Tabela ParticipacaoEquipe
CREATE TABLE SPF_PARTICIPACAO_EQUIPE (
	ID NUMBER GENERATED BY DEFAULT AS IDENTITY,
    NOME_USUARIO VARCHAR2(255) NOT NULL,
    EVENTO_ID NUMBER NOT NULL,
    MODALIDADE VARCHAR2(255) NOT NULL,
    CONSTRAINT PK_SPF_PARTICIPACAO_EQUIPE PRIMARY KEY (ID),
    CONSTRAINT FK_SPF_ATLETA_SPF_PARTICIPACAO_EQUIPE FOREIGN KEY (NOME_USUARIO) REFERENCES SPF_ATLETA(NOME_USUARIO),
    CONSTRAINT FK_SPF_EVENTO_SPF_PARTICIPACAO_EQUIPE FOREIGN KEY (EVENTO_ID) REFERENCES SPF_EVENTO(ID),
    CONSTRAINT SK_SPF_PARTICIPACAO_EQUIPE UNIQUE (NOME_USUARIO, EVENTO_ID, MODALIDADE)
);

-- Tabela PremiacaoIndividual
CREATE TABLE SPF_PREMIACAO_INDIVIDUAL (
    DATA_HORA TIMESTAMP NOT NULL,
	CATEGORIA VARCHAR2(255),
    TIPO VARCHAR2(255),
    ID_PARTICIPACAO NUMBER,
    CONSTRAINT PK_SPF_PREMIACAO_INDIVIDUAL PRIMARY KEY (DATA_HORA, CATEGORIA),
    CONSTRAINT FK_SPF_PREMIACAO_INDIVIDUAL FOREIGN KEY (ID_PARTICIPACAO) REFERENCES SPF_PARTICIPACAO_INDIVIDUAL(ID)
);

-- Tabela PremiacaoEquipe
CREATE TABLE SPF_PREMIACAO_EQUIPE (
    DATA_HORA TIMESTAMP NOT NULL,
	CATEGORIA VARCHAR2(255),
    TIPO VARCHAR2(255),
    ID_PARTICIPACAO NUMBER,
    CONSTRAINT PK_SPF_PREMIACAO_EQUIPE PRIMARY KEY (DATA_HORA, CATEGORIA),
    CONSTRAINT FK_SPF_PREMIACAO_EQUIPE FOREIGN KEY (ID_PARTICIPACAO) REFERENCES SPF_PARTICIPACAO_EQUIPE(ID)
);

-- Tabela ModalidadeEvento
CREATE TABLE SPF_MODALIDADE_EVENTO (
    EVENTO_ID NUMBER,
    MODALIDADE VARCHAR2(255),
    CONSTRAINT PK_SPF_MODALIDADE_EVENTO PRIMARY KEY (EVENTO_ID, MODALIDADE),
    CONSTRAINT FK_SPF_EVENTO_SPF_MODALIDADE FOREIGN KEY (EVENTO_ID) REFERENCES SPF_EVENTO(ID)
);

-- Tabela Experiencia
CREATE TABLE SPF_EXPERIENCIA (
    NOME_USUARIO VARCHAR2(255),
    DESCRICAO VARCHAR2(255),
    CONSTRAINT PK_SPF_EXPECIENCIA PRIMARY KEY (NOME_USUARIO, DESCRICAO),
    CONSTRAINT FK_SPF_ATLETA_SPF_EXPECIENCIA FOREIGN KEY (NOME_USUARIO) REFERENCES SPF_ATLETA(NOME_USUARIO)
);

-- Tabela Habilidade
CREATE TABLE SPF_HABILIDADE (
    NOME_USUARIO VARCHAR2(255),
    DESCRICAO VARCHAR2(255),
    CONSTRAINT PK_SPF_HABILIDADE PRIMARY KEY (NOME_USUARIO, DESCRICAO),
    CONSTRAINT FK_SPF_ATLETA_SPF_HABILIDADE FOREIGN KEY (NOME_USUARIO) REFERENCES SPF_ATLETA(NOME_USUARIO)
);

-- Tabela Curriculo
CREATE TABLE SPF_CURRICULO (
    NOME_USUARIO VARCHAR2(255),
    DATA DATE NOT NULL,
    CONSTRAINT PK_SPF_CURRICULO PRIMARY KEY (NOME_USUARIO),
    CONSTRAINT FK_SPF_ATLETA_SPF_CURRICULO FOREIGN KEY (NOME_USUARIO) REFERENCES SPF_ATLETA(NOME_USUARIO)
);
